```
import java.util.*;
import java.io.*;
public class Q17396 {
    static int n,m;
    static boolean[] sight;
    static long[] visit;
    static List<List<Con>> ls = new ArrayList<>();
    public static void main(String[] args) throws IOException {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        StringTokenizer st = new StringTokenizer(br.readLine());
        n = Integer.parseInt(st.nextToken());
        m = Integer.parseInt(st.nextToken());
        sight = new boolean[n]; // 0이면 안보이고 1이면 보임, 0번째 현재 유섬이 챔피언, 마지막 상대편
        visit = new long[n];
        Arrays.fill(visit, Long.MAX_VALUE);
        st = new StringTokenizer(br.readLine());
        for(int i=0; i<n; i++) if(st.nextToken().equals("1")) sight[i]=true;
        sight[n-1]=sight[0]=false;
        for(int i=0; i<n; i++) ls.add(new ArrayList<>());
        for(int i=0; i<m; i++) {
            st = new StringTokenizer(br.readLine());
            int a = Integer.parseInt(st.nextToken());
            int b = Integer.parseInt(st.nextToken());
            if (sight[a] || sight[b]) continue;
            int c = Integer.parseInt(st.nextToken());
            ls.get(a).add(new Con(b, c));
            ls.get(b).add(new Con(a, c));
        }
        CHK();
        if(visit[n-1]==Long.MAX_VALUE) System.out.println(-1);
        else System.out.println(visit[n-1]);
    }
    static void CHK(){
        PriorityQueue<Con> pq = new PriorityQueue<>((o1,o2)-> Long.compare(o1.cost,o2.cost));
        pq.add(new Con(0, 0));
        visit[0] = 0;

        while(!pq.isEmpty()){
            Con now = pq.poll();
            if(visit[now.target]<now.cost) continue;
            for(Con c:ls.get(now.target)){
                Long nc = visit[now.target]+c.cost;
                if(visit[c.target]>nc){
                    visit[c.target]=nc;
                    pq.add(new Con(c.target, visit[c.target]));
                }
            }
        }
    }
}
class Con{
    int target;
    long cost;
    Con(int target, long cost){
        this.target = target;
        this.cost = cost;
    }
}

```
